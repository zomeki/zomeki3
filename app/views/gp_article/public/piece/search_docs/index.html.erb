<form method="get" action="<%= @node.public_uri %>">
  <%- if @piece.category_types.present? -%>
  <div class="categories">
    <fieldset>
    <%- @piece.category_types.each do |category_type| -%>
      <legend><%= category_type.title %>で探す</legend>
      <div class="checkboxes">
        <div class="checkboxesContainer">
          <%= render 'categories', categories: category_type.public_root_categories %>
        </div>
      </div>
    <%- end -%>
    </fieldset>
  </div>
  <%- end -%>
  <div class="keyword">
    <label for="criteria_keyword">キーワードでさがす</label>
    <%= text_field_tag 'criteria[keyword]', @keyword %>
  </div>
  <%= hidden_field_tag 'operator_type', @operator_type %>
  <div class="submitters">
    <input type="submit" value="検索" />
  </div>
</form>

<script type="text/javascript">
$(function() {
  $('ul li.level1 > input:checkbox').on('click', function(e) {
    var checkboxes = $(this).siblings('ul').find('input:checkbox');
    checkboxes.prop('checked', $(this).prop('checked'));
  })
});
</script>
